<!--pages/idleInfo/idleInfo.wxml-->
<view class="container">
  <Swiper imageList="{{idleInfo.firstList}}" />

  <!-- 闲物详情 -->
  <view class="idleInfo">
    <view class="infoTop">
      <view class="left">
        <view class="price">
          <text class="icon">¥</text>
          <text>{{idleInfo.price}}</text>
          <text class="type">{{idleInfo.radio==0?'自提':'送货上门'}}</text>
        </view>
        <view class="name">{{idleInfo.name}}</view>
      </view>
      <!-- 手机号码 -->
      <view class="operation">
        <view class="copy button" bindtap="copyPhone"></view>
        <view class="dial button" bindtap="dialPhone">
          <van-icon name="phone" />
        </view>
      </view>
    </view>
    <!-- 备注 -->
    <view class="remark">{{idleInfo.remark}}</view>
    <!-- 配置 -->
    <view class="specification">
      <block wx:for="{{idleInfo.specification}}" wx:key="_id">
        <view class="specItem">
          <view class="name">{{item.name}}</view>
          <view class="value">{{item.value}}</view>
        </view>
      </block>
    </view>
  </view>

  <!-- 标签栏 -->
  <van-tabs active="{{ active }}" color="#407FF5" line-width="70" bind:change="onChange">
    <van-tab title="详情">
      <view class="detailsImage">
        <block wx:for="{{idleInfo.detailsList}}" wx:key="_id">
          <image class="image" src="{{item.path}}" mode="widthFix" />
        </block>
      </view>
    </van-tab>
    <van-tab title="评论">
      <view class="commentArea" wx:if="{{idleInfo._id}}">
        <view class="title">共{{commentSum}}条评论</view>
        <!-- 评论列表 -->
        <view class="commentList" style="padding-bottom: {{bottomLift+45}}px">
          <!-- 父评论 -->
          <view class="commentItem" wx:for="{{commentList}}" wx:key="_id">
            <view class="fatherComment">
              <image class="userPic" src="{{item.avatarUrl}}" />
              <!-- 评论内容 -->
              <view class="content" bindtap="replyComment" id="{{item._id}}" data-fid="{{item._openid}}" data-name="{{item.nickName}}">
                <view class="userName">
                  <text>{{item.nickName}}</text>
                  <text wx:if="{{postInfo._openid===item._openid}}" class="author">作者</text>
                </view>
                <!-- 父评论 内容 -->
                <view class="commentContent">
                  <text class="comment">{{item.content}}</text>
                  <text class="commentTime">{{item.createTime}}</text>
                </view>
                <!-- 子评论 回复 -->
                <view class="sonCommentItem" wx:for="{{item.child_comment}}" wx:key="_id" wx:for-item="child">
                  <image class="sonUserPic" src="{{child.avatarUrl}}" />
                  <view class="content" catchtap="answerComment" id="{{item._id}}" data-fid="{{child._openid}}" data-name="{{child.nickName}}">
                    <view class="userName">
                      <text>{{child.nickName}}</text>
                      <text wx:if="{{postInfo._openid===child._openid}}" class="author">作者</text>
                    </view>
                    <!-- 子评论 内容 -->
                    <view class="commentContent">
                      <text class="comment">
                        <text wx:if="{{child.replyType}}" class="reply">回复<text class="coverReply">{{child.toNickName}}</text>:</text>
                        <text>{{child.content}}</text>
                      </text>
                      <text class="commentTime">{{child.createTime}}</text>
                    </view>
                  </view>
                </view>
              </view>
            </view>
          </view>
        </view>
      </view>
    </van-tab>
  </van-tabs>

  <!-- 评论框 -->
  <view
    class="publishComment"
    wx:if="{{idleInfo._id && active == 1}}"
    style="padding-bottom: {{inputBottom ? inputBottom : bottomLift}}px"
    >
    <input
      class="input"
      type="text"
      confirm-type="send"
      confirm-hold="{{true}}"
      model:value="{{value}}"
      focus="{{focus}}"
      placeholder="{{placeholder}}"
      bindconfirm="hairComment"
      adjust-position="{{false}}"
      bindfocus="inputFocus"
      bindblur="inputBlur"
    />
    <view class="hair" bindtap="hairComment">发送</view>
  </view>
</view>
